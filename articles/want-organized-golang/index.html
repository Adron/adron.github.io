<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Adron's Thrashing Code</title>
    <meta name="description" content="">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="alternate" href="/feed.xml" type="application/rss+xml" title="Coder, Messenger, Recon, Infrastructure, Ops, &amp; A Sprinkling of Metal">
    <link rel="icon" type="image/png" href="/img/favicons/favicon-16x16.png" sizes="16x16">
    <link rel="icon" type="image/png" href="/img/favicons/favicon-32x32.png" sizes="32x32">
    <link rel="icon" type="image/png" href="/img/favicons/favicon-96x96.png" sizes="96x96">
    <link rel="apple-touch-icon" sizes="57x57" href="/img/favicons/apple-touch-icon-57x57.png">
    <link rel="apple-touch-icon" sizes="60x60" href="/img/favicons/apple-touch-icon-60x60.png">
    <link rel="apple-touch-icon" sizes="72x72" href="/img/favicons/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="76x76" href="/img/favicons/apple-touch-icon-76x76.png">
    <link rel="apple-touch-icon" sizes="114x114" href="/img/favicons/apple-touch-icon-114x114.png">
    <link rel="apple-touch-icon" sizes="120x120" href="/img/favicons/apple-touch-icon-120x120.png">
    <link rel="apple-touch-icon" sizes="144x144" href="/img/favicons/apple-touch-icon-144x144.png">
    <link rel="apple-touch-icon" sizes="152x152" href="/img/favicons/apple-touch-icon-152x152.png">
    <link rel="apple-touch-icon" sizes="180x180" href="/img/favicons/apple-touch-icon-180x180.png">
    <link rel="stylesheet" href="/css/custom.css">
    <link rel="stylesheet" href="/css/style.min.css">
    <script src="/js/modernizr.js"></script>
  </head>
  <body class="article-detail">
    <!--[if lt IE 8]>
    <p class="browserupgrade">You are using an <strong>outdated</strong> browser. Please <a href="http://browsehappy.com/">upgrade your browser</a> to improve your experience.</p>
    <![endif]-->
    <div class="header header-over large">
      <div class="container">
        <div class="row">
          <div class="col-md-3 col-sm-6 col-xs-6">
            <!-- Logo Image--><a href="/index.html" class="logo-image logo-animated"><img src="/img/logos/logo.png" alt="logo"></a>
            <!-- End of Logo Image-->
          </div>
          <div class="col-md-9 col-sm-6 col-xs-6">
            <!-- Menu-->
            <nav class="right helper">
              <ul class="menu sf-menu js-menu">
                <li><a href="#">Conf - Meetup - Events</a>
                  <ul>
                    <li><a href="/docs/Speaking-Presentations-Workshops/">Speaking - Presentations - Workshops</a></li>
                    <li><a href="/docs/calendar">Calendar of Engagements</a></li>
                  </ul>
                </li>
                <li><a href="/docs/thrashing-code-news/">Thrashing Code News</a></li>
                <li><a href="/docs/medium-_TOC_/">Medium</a></li>
                <li><a href="/docs/documentation/">Docs</a></li>
                <li><a href="#">Contact</a>
                  <ul>
                    <li><a href="/docs/contact">Message</a></li>
                    <li><a href="/docs/job-talk/">Hire</a></li>
                  </ul>
                </li>
                <li><a href="/docs/about/">About</a></li>
              </ul>
            </nav>
            <!-- End of Menu-->
          </div>
        </div>
      </div>
    </div>
    <div class="header-back header-back-simple header-back-small">
      <div class="header-back-container">
        <div class="container">
          <div class="row">
            <div class="col-md-12">
              <!-- Page Info-->
              <div class="page-info page-info-simple">
                <h1>I Want an Organized Go Project</h1>
                <p class="author">Written by <span class="author">Adron Hall</span> and published on <span>November, 04 of 2016.</span>
                </p>
                <div class="nav"><a href="/">« Home</a></div>
              </div>
              <!-- End Page Info-->
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="content">
      <div class="container">
        <div class="layout with-right-sidebar js-layout">
          <div class="row">
            <div class="col-md-9">
              <div class="main-content">
                <!-- Blog Page-->
                <article class="article">
                  <section class="content"><p><a href="http://www.pelotonseattle.com/"><img src="/articles/want-organized-golang/peloton.jpg" alt="Hacking @ Peloton"></a></p>
<p>After the last two cookbook style blog entries on a <a href="/articles/want-a-golang-cli/">basic <span class="caps">CLI</span></a> with a <a href="/articles/want-a-golang-service/">simple service</a> with Go there needed to be some organization around the projects. Here’s the next steps on getting those projects&nbsp;organized.</p>
<p><span class="more"></span></p>
<h2 id="1-workspace-directory">1. Workspace&nbsp;Directory</h2>
<p>Workspaces in Go are a simple structure of directories within a root. They include the following three&nbsp;directories:</p>
<ul>
<li>src - Used to store the Go source&nbsp;files.</li>
<li>pkg - This contains the package&nbsp;objects.</li>
<li>bin - As in so many other projects with compilable code, this contains the binary executable&nbsp;commands.</li>
</ul>
<p>The Go tool specifically uses this directory structure to place the respective files in the respective directories. One thing that isn’t entirely obvious is that the <code>src</code> directory is the only directory that should be put in source&nbsp;control.</p>
<p>Let’s setup one of the existing projects, I’ll take the <a href="https://github.com/Adron/golang-cli">golang-cli</a> that I wrote about here and set it up according to the actual workspace configuration that go tool&nbsp;expects.</p>
<p>Create a directory to use as the workspace and then create the three directories. I’m going to create this workspace directory within my own code project directory that I call <code>Codez</code>. It’s a directory I put all of my code projects of varying sorts in, be it C++, Erlang, or F# they all are somewhere in this&nbsp;directory.</p>
<pre><code class="lang-shell-script">mkdir GOLANG_WORK
cd GOLANG_WORK
mkdir src bin pkg
</code></pre>
<h2 id="2-gopath-environment-variable">2. <span class="caps">GOPATH</span> Environment&nbsp;Variable</h2>
<p>The <span class="caps">GOPATH</span> environment variable specifies the location of the working area for Go coding. It’s setup, and in this particular situation it would point to the <code>GOLANG_WORK</code> directory that I just created&nbsp;previously.</p>
<pre><code class="lang-shell-script">$ export GOPATH=$HOME/Codez/GOLANG_WORK
</code></pre>
<p>I wanted to have this upon restart, so I added an appropriate append to the $<span class="caps">PATH</span> variable by adding this to my <code>~/.bash_profile</code> file.</p>
<pre><code class="lang-shell-script"># GO Path Workspace
export GOPATH=~/Codez/GOLANG_WORK
export PATH=$PATH:$GOPATH/bin
</code></pre>
<p>With a simple sourcing of the file the new path variables were ready for&nbsp;use.</p>
<pre><code class="lang-shell-script">source ~/.bash_profile
</code></pre>
<p>Next I pulled in the previous projects. I’ll use these projects to show how the various Go tools work. I simply cloned both of them into the <code>src</code> path.</p>
<pre><code class="lang-shell-script">git clone
</code></pre>
<h2 id="3-import-paths">3. Import&nbsp;Paths</h2>
<p>Now, the import path is something that isn’t always immediately intuitive. I had to dive in and <span class="caps">RTFM</span> before I realized what was going on here. It also isn’t something that isn’t regularly discussed as a “first step” when learning Go. It isn’t, after all, part of the actual code syntax, it’s part of the ecosystem around the language and tooling. Ya know, the part that often is somewhat neglected as a first step in the learning&nbsp;process.</p>
<p>The import path is basically the path where the code goes within the <code>src</code> directory as relating to where it would be publicly shared. For a standard <a href="https://github.com">Github</a> account such as mine I should use github.com/Adron as the base path. To straighten out the organization here, from a Go perspective I changed the name of the folders in which I just cloned to the&nbsp;following.</p>
<p>These two folders within <code>$HOME/src/</code>:</p>
<pre><code class="lang-shell-script">golang-cli
golang-service
</code></pre>
<p>I moved&nbsp;to.</p>
<pre><code class="lang-shell-script">github.com/adron/golang-cli
github.com/adron/golang-service
</code></pre>
<p>Important to note, is that I moved these folders into a multi-level deep directory structure. I created a github.com directory instide the src directory and inside that I created the adron directory and then moved the golang-cli and golang-service projects respectively. I note this because if one navigates into <code>src</code> with finder, some other manager, or uses the command to move and attempts to <em>move</em> the directory like&nbsp;this:</p>
<pre><code class="lang-shell-script">mv src golang-cli github.com/adron/golang-cli
</code></pre>
<p>Many of the managers or otherwise will attempt to, and by default will create a folder called <em>github.com/adron/golang-cli</em> <span class="caps">NOT</span> a folder called <em>golang-cli</em> inside of a folder called <em>adron</em> inside of a folder called <em>github.com</em>. This is a pretty basic thing, but often can lead even the most experienced to mistakenly moving files around&nbsp;incorrectly.</p>
<h2 id="4-go-install-making-a-program-">4. Go Install (Making a&nbsp;Program)</h2>
<p>Now using the two existing Go Programs that I’ve just cloned, I can execute either of those via the command line by using the <code>go install</code> command. Navigating in the terminal to the root of the golang-cli program I then execute this at the root of that&nbsp;project.</p>
<pre><code class="lang-shell-script">go install
</code></pre>
<p>The other option, which can be typed in a terminal regardless of&nbsp;location.</p>
<pre><code class="lang-shell-script">go install github.com/adron/golang-cli
</code></pre>
<p>Now, for this particular application, with it installed I can now use the command <code>golang-cli</code>.</p>
<pre><code class="lang-shell-script">$ golang-cli
Hello, Person With No Name, please enter some text: Heather
Heather

word:  the-word
numb:  42012
fork:  true
</code></pre>
<p>Here I’ve entered the command and followed the prompt. Again, for reference check out the <a href="http://blog.adron.me/articles/want-a-golang-cli/">quick <span class="caps">CLI</span> I put together previously</a>.</p>
<p>For the the golang-service project it’s a little trickier because of how I setup the code. I had written the code to show a quick example of creating a service and then running that service via the command <code>go run service.go</code> or <code>go run service-twosi.go</code>. If I were to try to install the project via the <code>go install</code> command I’d get the following&nbsp;results.</p>
<pre><code class="lang-shell-script">go install github.com/adron/golang-service
# github.com/adron/golang-service
Codez/GOLANG_WORK/src/github.com/adron/golang-service/service.go:9: handler redeclared in this block
    previous declaration at Codez/GOLANG_WORK/src/github.com/adron/golang-service/service-twosi.go:10
Codez/GOLANG_WORK/src/github.com/adron/golang-service/service.go:13: main redeclared in this block
    previous declaration at Codez/GOLANG_WORK/src/github.com/adron/golang-service/service-twosi.go:30
</code></pre>
<p>The package <code>main</code> and the <em>handler</em> is declared twice. This causes a problem since the compiler doesn’t have a way to inform which one to build. For this example, what I would need to do is remove one of the handlers and one of the packages and just keep a singular one. With that I did a quick replace of the <em>service.go</em> file and replaced it with the contents of the <em>service-twosi.go</em>  example code. At this point my <em>service.go</em> code file looks like&nbsp;this.</p>
<pre><code class="lang-javascript">package main

<span class="keyword">import</span> (
   <span class="string">"encoding/json"</span>
   <span class="string">"fmt"</span>
   <span class="string">"net/http"</span>
   <span class="string">"log"</span>
)

func handler(w http.ResponseWriter, r *http.Request) {
   fmt.Fprintf(w, <span class="string">"Welcome to the early morning Amtrak Cascades, %s!"</span>, r.<span class="caps">URL</span>.Path[<span class="number">1</span>:])
}

type Message struct {
   Text string
}

func about (w http.ResponseWriter, r *http.Request) {

   m := Message{<span class="string">"Welcome to the Twosi <span class="caps">API</span>, build v0.0.001."</span>}
   b, err := json.Marshal(m)

   <span class="keyword">if</span> err != nil {
       panic(err)
   }

    w.Write(b)
}

func main() {
   http.HandleFunc(<span class="string">"/"</span>, handler)
   http.HandleFunc(<span class="string">"/about/"</span>, about)
   log.Fatal(http.ListenAndServe(<span class="string">":8080"</span>, nil))
}
</code></pre>
<p>Now I can run <code>go install</code> and run the service via the command line, from anywhere on machine. Just to test it out I issue the <code>golang-service</code> command and navigate in the browser to the <a href="http://localhost:8080/about/">http://localhost:8080/about/</a> path. Sure enough, the <span class="caps">JSON</span>&nbsp;appears.</p>
<pre><code class="lang-javascript">{
<span class="string">"Text"</span>: <span class="string">"Welcome to the Twosi <span class="caps">API</span>, build v0.0.001."</span>
}
</code></pre>
<h2 id="5-project-collateral">5. Project&nbsp;Collateral</h2>
<p>It’s all nice and groovy that I have a Go project and some code, but if I really want to make something out of it I should be a good open source citizen. This is where a few other pieces of the repository come together for the project. Now, one might say, “but that’s not part of the Go ecosystem/tooling/whatyamakallit” but that’s not being very respectable about your intent. I’ll admit, I make a mess of a repo now and again too, but these are some good things to include so your repository isn’t a confusing mess of code trash waiting to be set on&nbsp;fire.</p>
<ul>
<li>.github Directory and <em>gasp</em> some basic instructions and documentation. Inside the .github directory there are three key files that ought to be included with some notion of useful information. For these two projects I’ve added some basic contribution information <a href="/articles/want-a-golang-cli/">here</a> and <a href="/articles/want-a-golang-service/">here</a>.</li>
<li><span class="caps">README</span>.md with some simple instructions on getting started, installing, etc. This file also should always describe what a project is and what it is for. Another way to put it, the README.md should have some sort of mission&nbsp;description.</li>
<li>Badges <span class="amp">&amp;</span> Status should be shown in the <span class="caps">README</span>.md or in some way somewhere on or in the project. A popular way is using badges to show the status of the build, license, dependencies status, and related information about the project. I don’t have those displayed as of this blog entry, but will dive into that and continuous integration and delivery of Go in subsequent blog&nbsp;entries.</li>
</ul>
<p>That’s it for this write up. More to come and more news about these projects, paths to production, and related patterns and deployment techniques in the coming weeks. Stay tuned and if you’d like blog entry summaries and other updates delivered to your mailbox, check out <a href="/docs/thrashing-code-news/">Thrashing Code News</a>.</p>
<p>Cheers!</p>
<p><strong>References:</strong></p>
<ul>
<li>Peloton Seattle - This is the image at the top of this blog entry, and where I wrote 90% and put together 90% of the code. Per their website, “Peloton is a different approach to the traditional bike shop.  In addition to being a full service repair shop, our cafe offers meals made from ingredients sourced from local farms, coffee made from locally roasted beans, and beer brewed in Washington.  Peloton is your destination whether you’re craving a morning coffee and snack, you need bicycle maintenance and advice, or you want to grab a beer with your riding buddies.  Peloton provides delicious healthy food, professional bicycle service, and a variety of beverages for any time of the day.  We’d love to share our passions with&nbsp;you.”</li>
<li>The <a href="https://github.com/Adron/golang-cli">Go <span class="caps">CLI</span> Sample App</a> and <a href="https://github.com/Adron/golang-service">Go Service Sample</a>&nbsp;Repositories.</li>
</ul>
</section>
                </article>
                <!-- End of Blog Page-->
              </div>
            </div>
            <div class="col-md-3 hidden-sm hidden-xs">
              <div class="sidebar js-sidebar-fixed">
                <!-- Vertical Menu-->
                <div class="widget">
                  <!-- Search-->
                  <div class="search">
                    <form action="https://google.com/search" method="get">
                      <input type="hidden" name="sitesearch" value="http://blog.adron.me">
                      <input type="text" name="q" placeholder="search" class="search-input form-control"><i class="fa fa-search search-icon"></i>
                    </form>
                  </div>
                  <!-- End of Search-->
                </div>
                <div class="widget">
                  <h3 class="widget-title">Keyword Search</h3>
                  <!-- Tags-->
                  <ul class="tags">
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=terraform">terraform</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=kubernetes">kubernetes</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=immutable+infrastructure">immutable infrastructure</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=html">html</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=javascript">javascript</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=ubuntu">ubuntu</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=node pdx">node pdx</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=.NET fringe">.net fringe</a></li>
                    <li class="tag-item"><a href="https://www.google.com/search?sitesearch=http%3A%2F%2Fblog.adron.me&amp;q=videos">videos</a></li>
                  </ul>
                  <!-- End of Tags-->
                </div>
                <nav class="menu-vertical-wrapper">
                  <ul data-prepend-to=".js-layout" data-select="Menu" class="menu-vertical js-menu-vertical">
                    <li><a href="#">About</a>
                      <ul>
                        <li><a href="/docs/about/">Me, Adron</a></li>
                        <li><a href="#">My Hobbies</a>
                          <ul>
                            <li><a href="http://photos.adron.me">My Photos</a></li>
                          </ul>
                        </li>
                        <li><a href="/docs/Speaking-Presentations-Workshops">My Presentations</a></li>
                        <li><a href="/docs/documentation/">Collection of Docs & Notes</a></li>
                      </ul>
                    </li>
                  </ul>
                </nav>
                <div class="widget">
                  <h3 class="widget-title">Photos</h3>
                  <!-- Photos-->
                  <ul class="widget-recommended-products">
                    <!-- Photos-->
                    <li class="widget-recommended-product"><img src="/img/photos/IMG_1836.jpg" alt="Jon Oropeza" class="widget-recommended-product-img"><a href="http://photos.adron.me/Software/Meetups-N-Conferences/Conferences/Node-PDX-2016/i-D9qFQ6m" class="widget-recommended-product-link">
                        <h5 class="widget-recommended-product-link-title">Node PDX 2016<i class="fa fa-angle-right"></i></h5>
                        <p class="widget-recommended-product-link-description">Jon Oropeza @ Node PDX 2016</p></a></li>
                    <!-- End of Recommended product Item-->
                    <!-- Recommended product Item-->
                    <li class="widget-recommended-product"><img src="/img/photos/IMG_1812.jpg" alt="Liz Abinante" class="widget-recommended-product-img"><a href="http://photos.adron.me/Software/Meetups-N-Conferences/Conferences/Node-PDX-2016/i-g2m2hgP" class="widget-recommended-product-link">
                        <h5 class="widget-recommended-product-link-title">Node PDX 2016<i class="fa fa-angle-right"></i></h5>
                        <p class="widget-recommended-product-link-description">Liz Abinante @ Node PDX 2016</p></a></li>
                    <!-- End of Recommended product Item-->
                    <!-- Recommended product Item-->
                    <li class="widget-recommended-product"><img src="/img/photos/IMG_5709.jpg" alt="Praha hlavní nádraží" class="widget-recommended-product-img"><a href="http://photos.adron.me/Travels-N-Traversings/Across-the-Pond-2016-Travels/September-Krakow/Week-4-Prague/i-62ZPsPb" class="widget-recommended-product-link">
                        <h5 class="widget-recommended-product-link-title">Prague (Praha)<i class="fa fa-angle-right"></i></h5>
                        <p class="widget-recommended-product-link-description">Praha hlavní nádraží</p></a></li>
                    <!-- End of photos row one-->
                  </ul>
                  <ul class="widget-recommended-products">
                    <!-- Photos-->
                    <li class="widget-recommended-product"><img src="/img/photos/IMG_4417.jpg" alt="St Mary's Basilica" class="widget-recommended-product-img"><a href="http://photos.adron.me/Travels-N-Traversings/Across-the-Pond-2016-Travels/September-Krakow/Krakow/i-KnZf6pK/A" class="widget-recommended-product-link">
                        <h5 class="widget-recommended-product-link-title">St Mary's Basilica<i class="fa fa-angle-right"></i></h5>
                        <p class="widget-recommended-product-link-description">Bazylika Mariacka in Rynek Główny.</p></a></li>
                    <!-- End of Recommended product Item-->
                    <!-- Recommended product Item-->
                    <li class="widget-recommended-product"><img src="/img/photos/VSC_03.png" alt="Visual Studio Code" class="widget-recommended-product-img"><a href="http://photos.adron.me/Software/Software-Development/Visual-Studio-Things/i-LLW7WcD/A" class="widget-recommended-product-link">
                        <h5 class="widget-recommended-product-link-title">Visual Studio Code<i class="fa fa-angle-right"></i></h5>
                        <p class="widget-recommended-product-link-description">Images from a review of Visual Studio Code.</p></a></li>
                    <!-- End of Recommended product Item-->
                    <!-- Recommended product Item-->
                    <li class="widget-recommended-product"><img src="/img/photos/-home-adronhall-Pictures-Selection_002.png - Shutter_003.png" alt="" class="widget-recommended-product-img"><a href="http://photos.adron.me/Software/Software-Development/Ubuntu/i-CQsQ4zj/A" class="widget-recommended-product-link">
                        <h5 class="widget-recommended-product-link-title">Mono Develop & WebStorm<i class="fa fa-angle-right"></i></h5>
                        <p class="widget-recommended-product-link-description">Working through Mono Develop & WebStorm.</p></a>
                      <!-- End of photos row two-->
                    </li>
                  </ul>
                  <!-- End Photos-->
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="nav"><a href="/">« Home</a></div>
      </div>
    </div>
    <script src="/js/all.js"></script>
    <script src="/js/custom.js"></script>
    <!-- Google Tag Manager-->
    <noscript>
      <iframe src="//www.googletagmanager.com/ns.html?id=GTM-KMMZX2" height="0" width="0" style="display:none;visibility:hidden"></iframe>
    </noscript>
    <script>
      console.log(document.getElementById("search-google"));
      console.log(document.getElementById("search-google").innerText);
      
      var searchBox = document.getElementById("search-google");
      
      function googleSearch(search_string) {
        alert(search_string);
      }
      
      document.getElementById("search-google").addEventListener("onClick", function () {
        alert(document.getElementById("search-google").innerHTML);
      });
      
      document.getElementById("search-google").addEventListener("onClick", function () {
        googleSearch(document.getElementById("search-google").innerHTML)
      });
      
    </script>
    <script>
      (function (i, s, o, g, r, a, m) {
        i['GoogleAnalyticsObject'] = r;
        i[r] = i[r] || function () {
                  (i[r].q = i[r].q || []).push(arguments)
                }, i[r].l = 1 * new Date();
        a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
        a.async = 1;
        a.src = g;
        m.parentNode.insertBefore(a, m)
      })(window, document, 'script', 'https://www.google-analytics.com/analytics.js', 'ga');
      ga('create', 'UA-39158070-6', 'auto');
      ga('send', 'pageview');
    </script>
  </body>
</html>